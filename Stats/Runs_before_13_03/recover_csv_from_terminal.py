import re

# Input the training output text
training_output = """Training...
  2%|███▎                                                                                                                                  | 999/40000 [05:10<3:18:58,  3.27it/s]Episode 1000/40000 - Actor Loss: -0.2066, Critic Loss: 0.4729, Win Rate: 0.7540
  5%|██████▋                                                                                                                              | 1999/40000 [10:17<3:34:53,  2.95it/s]Episode 2000/40000 - Actor Loss: -0.0437, Critic Loss: 0.0872, Win Rate: 0.7740
  7%|█████████▉                                                                                                                           | 2999/40000 [15:27<3:00:17,  3.42it/s]Episode 3000/40000 - Actor Loss: 0.0289, Critic Loss: 0.0381, Win Rate: 0.7550
 10%|█████████████▎                                                                                                                       | 3999/40000 [20:41<2:54:43,  3.43it/s]Episode 4000/40000 - Actor Loss: 0.0326, Critic Loss: 0.0396, Win Rate: 0.7220
 12%|████████████████▌                                                                                                                    | 4999/40000 [25:49<3:11:42,  3.04it/s]Episode 5000/40000 - Actor Loss: 0.0326, Critic Loss: 0.0383, Win Rate: 0.7470
 15%|███████████████████▉                                                                                                                 | 5999/40000 [30:58<2:52:42,  3.28it/s]Episode 6000/40000 - Actor Loss: 0.0291, Critic Loss: 0.0396, Win Rate: 0.7360
 17%|███████████████████████▎                                                                                                             | 6999/40000 [36:10<2:45:34,  3.32it/s]Episode 7000/40000 - Actor Loss: 0.0287, Critic Loss: 0.0396, Win Rate: 0.7330
 20%|██████████████████████████▌                                                                                                          | 7999/40000 [41:17<2:48:04,  3.17it/s]Episode 8000/40000 - Actor Loss: 0.0282, Critic Loss: 0.0402, Win Rate: 0.7670
 22%|█████████████████████████████▉                                                                                                       | 8999/40000 [46:21<2:51:26,  3.01it/s]Episode 9000/40000 - Actor Loss: 0.0211, Critic Loss: 0.0384, Win Rate: 0.7260
 25%|█████████████████████████████████▏                                                                                                   | 9999/40000 [51:25<2:45:25,  3.02it/s]Episode 10000/40000 - Actor Loss: 0.0277, Critic Loss: 0.0398, Win Rate: 0.7690
 27%|████████████████████████████████████▎                                                                                               | 10999/40000 [56:34<2:20:35,  3.44it/s]Episode 11000/40000 - Actor Loss: 0.0282, Critic Loss: 0.0380, Win Rate: 0.7420
 30%|██████████████████████████████████████▉                                                                                           | 11999/40000 [1:01:44<2:13:40,  3.49it/s]Episode 12000/40000 - Actor Loss: 0.0145, Critic Loss: 0.0374, Win Rate: 0.7330
 32%|██████████████████████████████████████████▏                                                                                       | 12999/40000 [1:06:57<2:15:31,  3.32it/s]Episode 13000/40000 - Actor Loss: 0.0218, Critic Loss: 0.0379, Win Rate: 0.7340
 35%|█████████████████████████████████████████████▍                                                                                    | 13999/40000 [1:12:11<1:58:11,  3.67it/s]Episode 14000/40000 - Actor Loss: 0.0208, Critic Loss: 0.0369, Win Rate: 0.7230
 37%|████████████████████████████████████████████████▋                                                                                 | 14999/40000 [1:17:31<2:14:55,  3.09it/s]Episode 15000/40000 - Actor Loss: 0.0200, Critic Loss: 0.0363, Win Rate: 0.7170
 40%|███████████████████████████████████████████████████▉                                                                              | 15999/40000 [1:22:41<1:49:07,  3.67it/s]Episode 16000/40000 - Actor Loss: 0.0157, Critic Loss: 0.0380, Win Rate: 0.7580
 42%|███████████████████████████████████████████████████████▏                                                                          | 16999/40000 [1:27:55<2:13:33,  2.87it/s]Episode 17000/40000 - Actor Loss: 0.0158, Critic Loss: 0.0374, Win Rate: 0.7230
 45%|██████████████████████████████████████████████████████████▍                                                                       | 17999/40000 [1:33:04<2:05:38,  2.92it/s]Episode 18000/40000 - Actor Loss: 0.0105, Critic Loss: 0.0388, Win Rate: 0.7280
 47%|█████████████████████████████████████████████████████████████▋                                                                    | 18999/40000 [1:38:20<1:41:18,  3.46it/s]Episode 19000/40000 - Actor Loss: 0.0286, Critic Loss: 0.0398, Win Rate: 0.7210
 50%|████████████████████████████████████████████████████████████████▉                                                                 | 19999/40000 [1:43:34<1:46:40,  3.12it/s]Episode 20000/40000 - Actor Loss: 0.0067, Critic Loss: 0.0383, Win Rate: 0.7600
 52%|████████████████████████████████████████████████████████████████████▏                                                             | 20999/40000 [1:48:44<1:29:56,  3.52it/s]Episode 21000/40000 - Actor Loss: 0.0259, Critic Loss: 0.0386, Win Rate: 0.7420
 55%|███████████████████████████████████████████████████████████████████████▍                                                          | 21999/40000 [1:53:57<1:28:05,  3.41it/s]Episode 22000/40000 - Actor Loss: 0.0161, Critic Loss: 0.0363, Win Rate: 0.7310
 57%|██████████████████████████████████████████████████████████████████████████▋                                                       | 22999/40000 [1:59:10<1:34:04,  3.01it/s]Episode 23000/40000 - Actor Loss: 0.0186, Critic Loss: 0.0382, Win Rate: 0.7480
 60%|█████████████████████████████████████████████████████████████████████████████▉                                                    | 23999/40000 [2:04:20<1:26:41,  3.08it/s]Episode 24000/40000 - Actor Loss: 0.0228, Critic Loss: 0.0382, Win Rate: 0.7490
 62%|█████████████████████████████████████████████████████████████████████████████████▏                                                | 24999/40000 [2:09:33<1:13:57,  3.38it/s]Episode 25000/40000 - Actor Loss: 0.0255, Critic Loss: 0.0361, Win Rate: 0.7450
 65%|████████████████████████████████████████████████████████████████████████████████████▍                                             | 25999/40000 [2:14:42<1:15:42,  3.08it/s]Episode 26000/40000 - Actor Loss: 0.0180, Critic Loss: 0.0346, Win Rate: 0.7460
 67%|███████████████████████████████████████████████████████████████████████████████████████▋                                          | 26999/40000 [2:20:00<1:13:49,  2.94it/s]Episode 27000/40000 - Actor Loss: 0.0116, Critic Loss: 0.0355, Win Rate: 0.7300
 70%|████████████████████████████████████████████████████████████████████████████████████████████▍                                       | 27999/40000 [2:25:25<59:31,  3.36it/s]Episode 28000/40000 - Actor Loss: 0.1365, Critic Loss: 0.0388, Win Rate: 0.7470
 72%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                   | 28999/40000 [2:30:45<1:02:00,  2.96it/s]Episode 29000/40000 - Actor Loss: 0.0197, Critic Loss: 0.0373, Win Rate: 0.7450
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 29999/40000 [2:36:07<52:27,  3.18it/s]Episode 30000/40000 - Actor Loss: 0.0183, Critic Loss: 0.0344, Win Rate: 0.7300
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 30999/40000 [2:41:27<1:04:03,  2.34it/s]Episode 31000/40000 - Actor Loss: 0.0170, Critic Loss: 0.0334, Win Rate: 0.7650
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                          | 31999/40000 [2:46:48<43:32,  3.06it/s]Episode 32000/40000 - Actor Loss: 0.0259, Critic Loss: 0.0369, Win Rate: 0.7550
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 32999/40000 [2:52:07<39:39,  2.94it/s]Episode 33000/40000 - Actor Loss: 0.0043, Critic Loss: 0.0331, Win Rate: 0.7640
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                   | 33999/40000 [2:57:27<29:58,  3.34it/s]Episode 34000/40000 - Actor Loss: 0.0260, Critic Loss: 0.0355, Win Rate: 0.7390
 87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 34999/40000 [3:02:51<27:59,  2.98it/s]Episode 35000/40000 - Actor Loss: 0.0096, Critic Loss: 0.0343, Win Rate: 0.7750
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 35999/40000 [3:08:12<22:21,  2.98it/s]Episode 36000/40000 - Actor Loss: 0.0216, Critic Loss: 0.0347, Win Rate: 0.7280
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████          | 36999/40000 [3:13:34<16:10,  3.09it/s]Episode 37000/40000 - Actor Loss: 0.0117, Critic Loss: 0.0338, Win Rate: 0.7470
 95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 37999/40000 [3:19:03<10:22,  3.22it/s]Episode 38000/40000 - Actor Loss: 0.0180, Critic Loss: 0.0338, Win Rate: 0.7500
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 38999/40000 [3:24:30<05:14,  3.18it/s]Episode 39000/40000 - Actor Loss: 0.0178, Critic Loss: 0.0335, Win Rate: 0.7290
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 39999/40000 [3:29:55<00:00,  3.43it/s]Episode 40000/40000 - Actor Loss: 0.0151, Critic Loss: 0.0338, Win Rate: 0.7180
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40000/40000 [3:29:56<00:00,  3.18it/s]
 """

# Function to extract values
def extract_metrics(line):
    pattern = r"Episode (\d+)/40000 - Actor Loss: (-?\d+\.\d+), Critic Loss: (\d+\.\d+), Win Rate: (\d+\.\d+)"
    match = re.search(pattern, line)
    if match:
        episode, actor_loss, critic_loss, win_rate = match.groups()
        return f"{episode},{actor_loss},{critic_loss},{win_rate}"
    return None

# Process the training output
lines = training_output.strip().split('\n')
csv_data = ["Episode,Actor_Loss,Critic_Loss,Win_Rate"]  # CSV header

for line in lines:
    csv_row = extract_metrics(line)
    if csv_row:
        csv_data.append(csv_row)

# Write to CSV file
with open('training_metrics.csv', 'w') as f:
    for row in csv_data:
        f.write(row + '\n')

print("CSV file created successfully: training_metrics.csv")